\chapter{Segmentierung und Klassifizierung}
In diesem Abschnitt wird der Prozess der Klassifizierung eines GPS-Tracks bzw. dessen einzelne Abschnitte erklärt. Dies inkludiert den Segmentierungsvorgang sowie die Entscheidungsbäume als Schlussfolgerungsmodelle und endet mit dem Nachbearbeiten um Anordnungen mit sehr geringer Wahrscheinlichkeit (Kontextfehler) zu verhindern.

Unter dem Segmentierungsvorgang versteht man das Aufteile einer GPS-Spur in Abschnitte in welchen mit hoher Wahrscheinlichkeit nur ein Verkehrsmittel benutzt worden ist. Dabei wird versucht die Segmente zu finden in welchen man zu Fuß unterwegs war. Diese werden dann als Geh-Segmente gekennzeichnet. Die anderen Segmente werden als nicht Geh-Segmente klassifiziert. Dadurch, dass nur zwischen 2 temporären Verkehrsmitteln unterschieden wird, vereinfacht sich die  Verkehrsmittelbestimmung drastisch.

Nach der Segmentierung folgt die konkrete Bestimmung des jeweiligen Verkehrsmittels für die einzelnen Abschnitte welche aus dem Segmentierungsvorgang hervorgegangen sind. In dieser Arbeit wurde die Bestimmung mit Hilfe von Entscheidungsbäumen realisiert. Dabei gibt es einen Entscheidungsbaum für die Klassifizierung mit und einen für die Klassifizierung ohne GIS-Daten. 

Schlussendlich werden die klassifizierten Abschnitte ein letztes mal auf ihre Wahrscheinlichkeit in dieser Reihenfolge überprüft. Dies bedeutet, dass überprüft wird wie wahrscheinlich es ist, dass man die Abfolge von z.B. ``Auto->zu Fuß->Auto->zu Fuß->Auto`` in einer GPS-Spur vorfindet oder ob es sich doch um einen Fehler der Bestimmung durch den fehlenden Kontext handeln könnte. Diese letzte Überprüfung sieht die einzelnen Abschnitte also im Kontext der anderen und kann daher ein Letztes mal überprüfen ob das Ergebnis plausibel ist.
\clearpage

\section{Segmentierung}
\label{segmentierung}
Bei der Segmentierung geht es in erster Linie darum, den Umfang des Problems der Verkehrsmittelbestimmung zu verkleinern. Dies bedeutet, man versucht das angegebenen GPS-Tracksegment in Geh-Segment und nicht Geh-Segmente aufzuteilen und dadurch statt zwischen mehreren Verkehrsmitteln (Gehen, Bus, Zug, Auto, Fahrrad) nur mehr zwischen zwei Typen unterscheiden muss. Die genauere Unterscheidung kann dann in einem weiteren Schritt folgen in welchem jedoch schon klar ist wo es sich um ein Segment handelt in welchem eine Person zu Fuß unterwegs war oder nicht. 

Zheng sagt in diesem Zusammenhang, dass es zwischen jedem Wechsel eines Verkehrsmittels einen Abschnitt gibt bei welchem man zu Fuß unterwegs war, auch wenn dieser Abschnitt sehr klein ist. Ein Wechsel erfolgt nie direkt wie z.B. von einem Zug in den Bus ohne über einen Bahnsteig oder ähnliches gehen zu müssen. Diese Aussage hat sich aus seinen umfangreichen Testdaten ableiten lassen. Dies bedeutet, dass wenn ein Verkehrsmittelwechsel stattgefunden hat, dann gibt es auch Trackpunkte in welchen eine Geschwindigkeit und eine Beschleunigung von nahezu 0 zu erwarten ist. Daraus hat er folgenden Algorithmus bzw Regeln abgeleitet:  \cite{zheng_understanding_2010}

\begin{pitemize}
\item Finde alle Geh-Punkte und nicht Geh-Punkte des betrachteten Abschnitts oder Tracks anhand von Grenzwerten für Geschwindigkeit und Beschleunigung und fasse die aufeinander folgenden Punkte von selben Typ in Segmente zusammen.
\item Liegt die Distanz oder die Zeit eines solchen Segment unterhalb einer definierten Grenze so vereine dieses Segment mit dem Vorherigen.
\item Überschreitet ein Segment eine bestimmte Länge (200 Meter) ist es ein ``sicheres Segment``. Liegt die Distanz eines Segments jedoch unterhalb dieses Werts so ist es ein ``unsicheres Segment``. Überschreitet die Anzahl der aufeinander folgenden ``unsicheren Segmenten`` einen bestimmten Grenzwert so werden die  aufeinander folgenden ``unsicheren Segmenten`` vereint und als nicht-geh-Segment betrachtet.
\end{pitemize}

Biljeki ergänzt diesen Ansatz von Zheng mit seinen Erfahrungen in welchen er feststellte, dass bei einem Wechsel des Verkehrsmittels auch oft das Signal verloren geht. Aus diesem Grund beendet Biljecki ein Segment, wenn die Verbindung verloren wurde und startet ein Neues. Den Verbindungsverlust interpretiert Biljecki so, dass er für mindestens 30 Sekunden keinen weiteren Trackpoint findet. Weiters segmentiert Biljecki dann, wenn er für mehr als 12 Sekunden keine bzw. wenig Bewegung (< 2km/h) festellen konnte. Diese beiden Änderungen an dem Algorithmus von Zheng begründet Biljecki damit, dass eine Übersegmentierung besser ist als eine Untersegmentierung. Aufeinander folgende Segmente mit dem selben Typ kann man immer noch in einem nächsten Schritt zusammenlegen. \cite{biljecki_transportation_2013}

Für den Prototypen wurde im wesentlichen der durch Biljecki erweiterte Ansatz von Zheng gewählt mit der Einschränkung, dass die Klassifizierung in ``sichere`` und ``unsichere`` Segemente nicht übernommen wurde. Dies wurde mit der Aussage von Biljecki begründet, dass eine Übersegmentierung besser ist als eine Untersegmentierung. Das Resultat eines Segmentierungsvorgangs kann man in Abbildung \imgref{segmentierung} sehen. Jeder Kreis auf der eingezeichneten Route zeigt den Start bzw. das Ende eines Segments. Auf Basis dieser ersten Aufteilung kann nun die genauere Bestimmung des Verkehrsmittels erfolgen.

\img{0.75}{document/graphics/segmentierung.png}{Grundlegende Segmentierung}{segmentierung}
\clearpage

\section{Schlussfolgerungsvariablen}
\label{schlussfolgerungsvariablen}
Als Grundlage für die Schlussfolgerung durch die Entscheidungsbäume müssen zuerst Variablen die für die Schlussfolgerung sehr wichtig bzw. möglichst ausschlaggebend für die betrachteten Verkehrsmittel sind, festgelegt werden. Dies Variablen können dabei diverse geschwindigkeitsabhängige Werte wie durchschnittliche und maximale Geschwindigkeit sein oder auch Beschleunigungswerte und  Abstände zu bestimmten Infrastrukturen. Eine Übersicht über die Schlussfolgerungsvariablen in den betrachteten Publikationen ist in der Tabelle \ref{variablenuebersicht} abgebildet. Diese Werte sind nach der Anzahl der Vorkommnisse in den Publikationen gereiht und bildet eine Grundlage für die in dieser Arbeit verwendeten Variablen. 

Aus Gründen der Vollständigkeit muss noch erwähnt werden, dass aufgrund eines anderen Segmentierungsverfahrens nicht alle Variablen von Gonzales  \cite{gonzalez_automating_2010} aufgeführt sind. Außerdem handelt es sich bei der maximalen Geschwindigkeit nicht um das absolute Maximum sondern um 95\% davon bzw. ist es die dritt höchste Geschwindigkeit die gemessen wurde. 

Weiters muss noch erwähnt werden, dass sowohl Zheng  \cite{zheng_understanding_2010} als auch Stenneth \cite{stenneth_transportation_2011} nicht alle Variablen schlussendlich verwendet haben. Sie haben sich allerdings evaluiert, welche Variablen in ihrem Projekt die größte Wirkung zeigen. Dies war bei Zheng \cite{zheng_understanding_2010} die Kombination von der Stopprate, der Geschwindigkeitsänderungsrate und der Richtungsänderungsrate. Fügte er weitere Variablen hinzu konnte eine Verschlechterung der Ergebnisse beobachten. Bei Stenneth \cite{stenneth_transportation_2011} hat die Evaluierung ergeben, dass die durchschnittliche Geschwindigkeit und Beschleunigung kombiniert mit verschiedenen GIS-Werten das beste Ergebnis geliefert. 

Die betrachtet GIS-Werte waren bei Stenneth \cite{stenneth_transportation_2011} der durchschnittliche Abstand zu Gleisen, Bussen und dem Buskandidat (jener Bus in dem sich die Person am ehesten Befand). Biljecki verwendete den Abstand zu Gleisen, Bushaltestellen, Buslinien, U-Bahn und Straßenbahn als Indikatoren für die Schlussfolgerung. Schüssler \cite{nadine_schussler_improving_2011} inkludiert von den möglichen GIS-Werten nur den Abstand zu öffentlichen Verkehrsmitteln aller Art.

\subsection{Reihung der allgemeinen Variablen}
Die in dieser Arbeit verwendeten Schlussfolgerungsvariablen basieren auf der Reihung welche in Tabelle \ref{variablenuebersicht} ersichtlich ist. Die allgmeine Geschwindigkeit an fünfter Stelle wurden deshalb übersprungen, weil sie bereits zwei mal vertreten ist und bereits Zheng gesagt hat, dass die Geschwindigkeit allein kein aussagekräftiger Indikator für ein Verkehrsmittel ist \cite{zheng_understanding_2010}. 

\begin{pitemize}
\item durchschnittliche Geschwindigkeit
\item maximale Geschwindigkeit
\item durchschnittliche Beschleunigung
\item maximale Beschleunigung
\item Stopprate
\end{pitemize}


\subsection{Reihung der GIS-Variablen}
Bei der Auswahl der GIS-Variablen fallen jene mit U-Bahn und Straßenbahn weg, da es diese im Raum Vorarlberg nicht gibt. Jene Variablen die spezifische GPS-Daten von einzelnen Verkehrsmitteln benötigen, konnten auch Aufgrund von fehlenden Schnittstellen nicht verwendet werden. Somit wurden folgende Variablen für die GIS-gestützte Analyse verwendet:

\begin{pitemize}
\item durchschnittliche Nähe zu Busstationen
\item durchschnittliche Nähe zu Bahnhöfen
\item durchschnittliche Nähe zu Gleisen	
\item durchschnittliche Nähe zu Autobahnen
\end{pitemize}
\clearpage

\begin{landscape}
\begin{table}[h]
\centering
\begin{tabular}{|l|c|c|c|c|c|c|c|}
\hline
 & \multicolumn{1}{l|}{Zheng\textsuperscript{1}} & \multicolumn{1}{l|}{Stenneth\textsuperscript{2}} & \multicolumn{1}{l|}{Reddy\textsuperscript{3}} & \multicolumn{1}{l|}{Biljecki\textsuperscript{4}} & \multicolumn{1}{l|}{Gonzales\textsuperscript{5}} & \multicolumn{1}{l|}{Schüssler\textsuperscript{6}} & \multicolumn{1}{l|}{\textbf{Gesamt}} \\ \hline
durchschn. Geschwindigkeit & x & x &  & x & x & x & \textbf{5} \\ \hline
max. Geschwindigkeit * & x &  &  & x & x &  & \textbf{3} \\ \hline
durchschn. Beschleunigung &  & x & x &  & x &  & \textbf{3} \\ \hline
verwendet GIS Daten &  & x &  & x &  & x & \textbf{3} \\ \hline
Geschwindigkeit &  &  & x &  &  & x & \textbf{2} \\ \hline
max. Beschleunigung & x &  &  &  & x &  & \textbf{2} \\ \hline
Richtungswechselrate & x & x &  &  &  &  & \textbf{2} \\ \hline
Distanz des Segments & x &  &  &  &  &  & \textbf{1} \\ \hline
Distanz des Tracks &  &  &  &  & x &  & \textbf{1} \\ \hline
Geschwindigkeitswechselrate & x &  &  &  &  &  & \textbf{1} \\ \hline
Stopprate & x &  &  &  &  &  & \textbf{1} \\ \hline
durchschn. Varianz d. Beschl. &  &  &  &  &  & x & \textbf{1} \\ \hline
durchschn. beweg. Geschw. &  &  &  & x &  &  & \textbf{1} \\ \hline
durchschn. Genauigkeit &  & x &  &  &  &  & \textbf{1} \\ \hline
erwartete Geschwindigkeit & x &  &  &  &  &  & \textbf{1} \\ \hline
Varianz d. Geschwindigkeit & x &  &  &  &  &  & \textbf{1} \\ \hline
\end{tabular}
\caption{Entscheidungsvariablenübersicht}
\textsuperscript{1} \cite{zheng_understanding_2010}, \textsuperscript{2} \cite{stenneth_transportation_2011}, \textsuperscript{3} \cite{reddy_using_2010}, \textsuperscript{4} \cite{biljecki_transportation_2013}, \textsuperscript{5} \cite{gonzalez_automating_2010}, \textsuperscript{6} \cite{nadine_schussler_improving_2011}
\label{variablenuebersicht}
\end{table}
\end{landscape}

\section{Berechnung der allgemeinen Entscheidungsvariablen}
Das Hinzufügen und Berechnen der Entscheidungsvariablen ohne GIS-Daten, wird von dem Tracksegment-Filter (siehe Abschnitt \nameref{tracksegmentFilter}), realisiert. Dabei ist die Berechnung der grundlegenden Geschwindigkeit zwischen zwei GPS-Punkten essentiell da alle weiteren Entscheidungsvariablen darauf aufbauen. 

\subsection{Geschwindigkeit}
Berechnet wurde die Geschwindigkeit (v) als Durchschnittsgeschwindigkeit, die als Verhältnis vom zurückgelegten Weg (s) zur Zeit (t) ausdrückt wird, wie es z.B. im Buch ``Physik`` von Douglas Giancoli definiert wird \cite[S.~27]{douglas_giancoli_physik_2010} und in \ref{geschwindigkeitsformel} ersichtlich ist. 
\begin{equation}
v = \frac{s}{t}
\label{geschwindigkeitsformel}
\end{equation}

Die Zeit ist dabei die Differenz zwischen den Zeitstempeln von zwei GPS-Trackpunkten und der Weg die Differenz zwischen den zwei Koordinaten. Zur Berechnung des Weges (der Luftlinienentfernung) zwischen zwei Koordinaten gibt es laut \cite{movable_type_ltd_calculate_2015} mehrere Möglichkeiten. Welche man verwendet hängt von den Längen der betrachteten Strecken, der gewünschten Genauigkeit sowie der gewünschten Zeit ab. Da es sich bei den hier betrachteten Distanzen immer um sehr kleine Distanzen im Verhältnis zur Erde selbst handelt aber diese aufgrund ihrer weiteren Verwendung zur Berechnung der Geschwindigkeit möglichst genau sein soll wird in diesem Prototyp die Haversine-Formel (siehe die Gleichungen \ref{haversineformel}) verwendet. Dabei sind $\varphi$ die Breitengrade, $\lambda$ die Längengrade, R der Erdradius und $\triangle\varphi$ bzw. $\triangle \lambda$ die Differenz der Breiten- bzw. Längengrade.\cite{movable_type_ltd_calculate_2015}

\begin{equation}
\label{haversineformel}
\begin{aligned}
a &= sin^{2}(\triangle \varphi/2) + cos \varphi_1  * cos \varphi_2 * sin^{2}(\triangle \lambda/2) \\
c &= 2 * atan2( \sqrt{a}, \sqrt{(1-a)}) \\
d &= R * c
\end{aligned}
\end{equation}

\paragraph{Durchschnittliche Geschwindigkeit} Die durchschnittliche Geschwindigkeit wird über alle Geschwindigkeitswerte eines Segments berechnet.

\paragraph{Maximale Geschwindigkeit} Die maximale Geschwindigkeit wird aus allen Geschwindigkeitwerten des Segments ermittelt. Dabei ist aber anzumerken, dass nicht die absolute Geschwindigkeit sondern die 3. höchste Geschwindigkeit verwendet wird um fehlerhaften Ausreißern vorzubeugen.

\subsection{Beschleunigung}
Die Beschleunigung ist als Geschwindigkeitsunterschied zwischen zwei Punkten pro Zeiteinheit definiert \cite[S.~51]{douglas_giancoli_physik_2010}. Somit wurde diese auf Basis der ermittelten Geschwindigkeit berechnet und darüber folgende zwei Entscheidungsvariablen bestimmt. 

\paragraph{Durchschnittliche Beschleunigung} Die durchschnittliche Beschleunigung für das betrachtete Segment. 

\paragraph{Maximale Beschleunigung} Die maximal gemessene Beschleunigung für das betrachtete Segment.

\subsubsection{Stopprate}
Wie Zheng in \cite{zheng_understanding_2010} beschrieben hat, ist die Geschwindigkeit als Basis für Entscheidungsvariablen nur bedingt geeignet, da diese sehr von der aktuellen Verkehrssituation abhängig ist. Deshalb setzt Zheng auf die Kombination von Richtungswechsel, Geschwindigkeitswechsel und der Stopprate. Dieser Aussage widerspricht allerdings die Auswahl der Entscheidungsvariablen von anderen Autoren wie Biljecki  \cite{biljecki_transportation_2013}, Gonzales \cite{gonzalez_automating_2010}, Schüssler \cite{nadine_schussler_improving_2011} und Reddy \cite{reddy_using_2010}. 

Die Stopprate ist für Zheng in so fern sehr aussagekräftig, da er an spezifischen Verkehrsmitteln auch eine spezifische Stopprate bzw. ein Stoppverhalten festmachen kann. Dies ist Beispielhaft in Abbildung \ref{stop_rate_zheng} ersichtlich. Dabei stoppt eine Person im Auto (a) wesentlich weniger oft wie zum Beispiel ein Bus (b) da dieser z.B. auch bei Bushaltestellen anhalten muss. Noch öfter stoppt laut Zheng nur ein Fußgänger (c) \cite{zheng_understanding_2010}. Im Falle des Prototyps ist wird die Erkennung von Stopps bereits beim Segmentieren benötigt und dadurch, dass die anderen Entscheidungsvariablen sehr auf die Geschwindigkeit basieren, wurde die Stopprate als weitere Entscheidungsvariable die nicht abhängig von der Geschwindigkeit ist ausgewählt. 

\img{0.75}{document/graphics/stop_rate_zheng.png}{Stopprate laut Zheng (Quelle: \cite{zheng_understanding_2010})}{stop_rate_zheng}


\clearpage

\section{Aufbereitung mit GIS-Daten}
%\item durchschnittliche Nähe zu Busstationen
%\item durchschnittliche Nähe zu Bahnhöfen
%\item durchschnittliche Nähe zu Gleisen	
%\item durchschnittliche Nähe zu Autobahnen
\subsubsection{Durchschnittliche Geschwindigkeit}
\subsubsection{Maximale Geschwindigkeit}
\subsubsection{Durchschnittliche Beschleunigung}
\subsubsection{Maximale Beschleunigung}
\subsection{Abstand zu Bushaltestellen}
\subsection{Abstand zu Gleisen}

\clearpage

\section{Zusammenfassung}
\todo{zusammenfassung processing?}